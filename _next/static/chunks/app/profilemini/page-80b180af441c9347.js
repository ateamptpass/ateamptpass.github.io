(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[191],{6647:function(){},8425:function(e,o,r){Promise.resolve().then(r.bind(r,7707))},7707:function(e,o,r){"use strict";r.r(o);var t=r(7437),s=r(2265),n=r(5430),i=r(7075),c=r(5856),a=r(4730),l=r(3562);r(9930).config();let p=(0,n.Pi)(()=>{let[e,o]=(0,s.useState)(!0),r=(0,l.$)("clientId"),n=(0,l.$)("secret"),p=(0,l.$)("callbackUrl"),[u,d]=(0,s.useState)(!1),[f,g]=(0,s.useState)(""),[m,h]=(0,s.useState)("");return(0,s.useEffect)(()=>{setTimeout(()=>{o(!1)},2e3)},[]),(0,s.useEffect)(()=>{var e,o;let r=new URLSearchParams(window.location.search),t=r.get("code"),s=r.get("state"),n=null!==(e=r.get("error"))&&void 0!==e?e:"",i=null!==(o=r.get("error_description"))&&void 0!==o?o:"";if(h("Error: "+n),g("Error description: "+i),t){let e=(0,l.$)("appName"),o=(0,l.$)("scope");a.Z.getCustomerProfile({appName:e,clientID:"174590c2-5698-49e5-b6dc-7298154d3fbd",clientSecret:"1ngPbi9oplzCKddqhXw4CrKL0KhRiIEg",code:null!=t?t:"",state:null!=s?s:"",redirectURI:"https://ptid-miniapp.ddns.net/profilemini/index.html",scope:null!=o?o:""})}else d(!0),console.log(u),console.log(f)},[]),(0,t.jsx)(i.im,{children:e?(0,t.jsx)(i.RW,{}):(0,t.jsxs)(i.tz,{children:[u?(0,t.jsx)(i.$0,{children:(0,t.jsx)(i.r3,{children:"Error Results"})}):(0,t.jsx)(i.$0,{children:(0,t.jsx)(i.r3,{children:"Profile"})}),(0,t.jsxs)("div",{children:["clientID: ",r]}),(0,t.jsxs)("div",{children:["clientSecret: ",n]}),(0,t.jsxs)("div",{children:["redirectURI: ",p]}),(0,t.jsxs)("div",{children:["accessToken: ",a.Z.exchangeTokenRes]}),a.Z.customerProfileErrorCodeResponse?(0,t.jsx)(i.wF,{error:a.Z.customerProfileErrorCodeResponse.code,errorDetail:a.Z.customerProfileErrorCodeResponse.message}):a.Z.customerProfileResponse?(0,t.jsx)(i.dk,{responseData:a.Z.customerProfileResponse,responseSelfieImageData:a.Z.getSelfieImageResponse}):a.Z.exchangeTokenApiError?(0,t.jsx)(i.wF,{error:"Error",errorDetail:"exchange Token Api catch"}):a.Z.customerProfileApiError?(0,t.jsx)(i.wF,{error:"Error",errorDetail:"An invalid response was received from the upstream server"}):u?(0,t.jsx)(i.wF,{error:m,errorDetail:f}):(0,t.jsx)(i.RW,{}),(0,t.jsx)(i.r0,{textName:"กลับสู่หน้าแรก",onClick:()=>{(0,c.t)("inputpage",!0),window.location.href="https://ptid-miniapp.ddns.net/"},buttonProps:{marginBottom:"10px"}})]})})});o.default=p},3562:function(e,o,r){"use strict";r.d(o,{$:function(){return s},q:function(){return t}});let t=(e,o)=>{localStorage.setItem(e,JSON.stringify(o))},s=e=>{{let o=localStorage.getItem(e);return o?JSON.parse(o):null}}},5856:function(e,o,r){"use strict";r.d(o,{G:function(){return s},t:function(){return t}});let t=(e,o)=>{sessionStorage.setItem(e,JSON.stringify(o))},s=e=>{let o=sessionStorage.getItem(e);return o?JSON.parse(o):null}},4730:function(e,o,r){"use strict";var t=r(305),s=r(4228);class n{async getCustomerProfile(e){console.log("getCustomerProfile",e),(0,s.ZO)(e).then(o=>{(0,t.z)(()=>{var r;if((null===(r=o.data)||void 0===r?void 0:r.code)!="0000")this.customerProfileErrorCodeResponse=o.data,console.log("Exchange Token Fail");else if(console.log("Exchange Token Success"),this.exchangeTokenRes=o.data.data.access_token,o.data.data.access_token){let r=null!==(n=o.data.data.access_token)&&void 0!==n?n:"";var n,i={appName:e.appName,accessToken:r};if((0,s.VW)(i).then(e=>{(0,t.z)(()=>{var o;(null===(o=e.data)||void 0===o?void 0:o.code)!="0000"?(this.customerProfileErrorCodeResponse=e.data,console.log("GetCustomer Profile Fail")):(console.log("GetCustomer Profile Sucess"),this.customerProfileResponse=e.data)})}).catch(e=>{(0,t.z)(()=>{console.log("call api GetCustomer Profile error"),this.customerProfileApiError=!0})}),e.scope.includes("paotangid.selfie_image")){console.log("call get selfie image");let o="";switch(e.appName){case"app-sit":o="app-sit-selfie-image";break;case"app-sit-sandbox":o="app-sit-selfie-image-sandbox";break;default:console.log("app name not sit")}i={appName:o,accessToken:r},(0,s.VW)(i).then(e=>{(0,t.z)(()=>{var o;(null===(o=e.data)||void 0===o?void 0:o.code)!="0000"?(this.customerProfileErrorCodeResponse=e.data,console.log("Get Selfie Image Fail")):(console.log("Get Selfie Image Success"),this.getSelfieImageResponse=e.data)})}).catch(e=>{(0,t.z)(()=>{console.log("call api Get Selfie Image error"),this.customerProfileApiError=!0})})}}else console.log("call api Exchange Token error"),this.exchangeTokenApiError=!0})}).catch(e=>{(0,t.z)(()=>{console.log("call api error"),this.exchangeTokenApiError=!0})})}constructor(){this.customerProfileResponse=null,this.customerProfileErrorCodeResponse=null,this.getSelfieImageResponse=null,this.exchangeTokenRes=null,this.customerProfileApiError=!1,this.exchangeTokenApiError=!1,(0,t.rC)(this,{customerProfileResponse:t.LO,customerProfileErrorCodeResponse:t.LO,customerProfileApiError:t.LO,getSelfieImageResponse:t.LO,exchangeTokenApiError:t.LO,exchangeTokenRes:t.LO,getCustomerProfile:t.aD})}}let i=new n;o.Z=i},4228:function(e,o,r){"use strict";r.d(o,{VW:function(){return n},ZO:function(){return s},lO:function(){return i}});var t=r(2126);r(9930).config();let s=async e=>{let o="".concat("https://paotang-pass-external-sit.th-service.co.in/").concat("v1/paotangpass/customer-utility/exchange-token");return await t.Z.post(o,e)},n=async e=>{let o="".concat("https://paotang-pass-external-sit.th-service.co.in/").concat("v1/paotangpass/customer-utility/get-customer-profile");return await t.Z.post(o,e)},i=async(e,o)=>{let r="".concat(o).concat("/oauth2/web/auth","?client_id=").concat(e.client_id,"&redirect_uri=").concat(e.redirect_uri,"&response_type=").concat(e.response_type,"&scope=").concat(e.scope,"&state=").concat(e.state);e.acr&&""!==e.acr.trim()&&(r+="&acr=".concat(e.acr)),e.prompt&&""!==e.prompt.trim()&&(r+="&prompt=".concat(e.prompt)),e.purpose&&""!==e.purpose.trim()&&(r+="&purpose=".concat(e.purpose)),window.open(r)}}},function(e){e.O(0,[676,147,218,520,190,126,75,971,23,744],function(){return e(e.s=8425)}),_N_E=e.O()}]);
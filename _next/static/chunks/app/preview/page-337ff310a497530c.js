(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[639],{6647:function(){},4838:function(t,e,n){Promise.resolve().then(n.bind(n,685))},685:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return h}});var c=n(7437),o=n(2265),r=n(3562),i=n(8883),a=n(6952),s=n(4687),l=n(305),u=n(4228);class p{async onInitialWebAuth(t,e){(0,u.lO)(t,e)}constructor(){this.initialWebAuthRequest=null,(0,l.rC)(this,{initialWebAuthRequest:l.LO})}}let d=new p;var w=()=>{var t;let e=(0,r.$)("clientId"),n=(0,r.$)("secret"),c=null!==(t=(0,r.$)("callbackUrl"))&&void 0!==t?t:"",o=(0,r.$)("scope"),i=(0,r.$)("acr")||null,a=(0,r.$)("prompt")||null,s=(0,r.$)("purpose")||null,l=(0,r.$)("environment"),u=(0,r.$)("state");d.onInitialWebAuth({client_id:e,redirect_uri:c,response_type:"code",secret:n,scope:o,state:u,acr:i,prompt:a,purpose:s},l)},h=()=>{a.featureInquireInfo.jsBridgeValue;let[t,e]=(0,o.useState)(!0),[n,l]=(0,o.useState)("");(0,r.$)("clientId"),(0,r.$)("secret"),(0,r.$)("callbackUrl");let[u,p]=(0,o.useState)(!1),[d,h]=(0,o.useState)(""),[b,f]=(0,o.useState)(""),[g,m]=(0,o.useState)(!1),[$,k]=(0,o.useState)(""),[v,x]=(0,o.useState)(!1),I=()=>{let t=(0,r.$)("flow");"mini-app"==t?(0,s.Z)():"qr"==t&&w()},S=(t,e,n,c)=>{if(window.JSBridge){var o,r;window.bridge.initAuthCallback=n,window.bridge.initAuthCallbackError=c,null===(o=(r=window.JSBridge).initAuth)||void 0===o||o.call(r,t,e)}else window.webkit&&(window.bridge.initAuthCallback=n,window.bridge.initAuthCallbackError=c,window.webkit.messageHandlers.observer.postMessage({name:"initAuth",clientId:t,scope:e}))},j=(t,e)=>{p(!0),h("init auth error: "+t),f("Error description: "+e)},A=t=>{t.includes("error")&&x(!0),m(!0),k(t)};return(0,o.useEffect)(()=>{window.bridge={initAuthErrorCallback:j,initAuthCallbackOption:A}},[]),(0,o.useEffect)(()=>{var t;let e=(0,r.$)("clientId");(0,r.$)("secret");let n=(0,r.$)("callbackUrl"),c=(0,r.$)("scope"),o=(0,r.$)("acr"),i=(0,r.$)("prompt"),a=(0,r.$)("purpose"),s=(0,r.$)("environment"),u=(0,r.$)("state"),p=null!==(t=(0,r.$)("callback"))&&void 0!==t?t:"",d=(0,r.$)("flow");"mini-app"==d?window.JSBridge?l("window.JSBridge.initAuth?.(".concat(e,",").concat(n,",code,").concat(c,",").concat(u,",").concat(i,",").concat(a,",").concat(o,",").concat(p,")")):window.webkit&&l("window.webkit.messageHandlers.observer.postMessage({name: initAuth,clientId:".concat(e,",redirectUri:").concat(n,",responseType:code,scope:").concat(c,",state:").concat(u,",prompt:").concat(i,",purpose:").concat(a,",acrValue:").concat(o,",callbackOption:").concat(p,"})")):"qr"==d&&l("".concat(s,"/oauth2/web/auth?.(").concat(e,",").concat(n,",code,").concat(c,",").concat(u,",").concat(i,",").concat(a,",").concat(o,")"))},[]),(0,o.useEffect)(()=>{setTimeout(()=>{e(!1)},2e3)},[]),(0,c.jsx)(i.im,{children:(0,c.jsx)(i.tz,{children:t?(0,c.jsx)(i.RW,{}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(i._x,{buttonprops:{marginBottom:200},onBtnBackClick:()=>{history.back()}}),u?(0,c.jsx)(i.wF,{error:d,errorDetail:b}):g?(0,c.jsx)(i.LM,{isCallbackError:v,callback:$}):(0,c.jsxs)(i.Z9,{children:[(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(i.nj,{textName:"Command",textProps:{fontWeight:"600"}}),(0,c.jsx)(i.oU,{JSbridgeValue:n})]}),(0,c.jsx)(i.r0,{textName:"เข้าสู่ระบบ PaotangID",id:"button_next",onClick:()=>{I()}}),(0,c.jsx)(i.r0,{textName:"เข้าสู่ระบบ PaotangID Mini App",id:"button_next",onClick:()=>{S((0,r.$)("clientId"),(0,r.$)("scope"),t=>{window.location.href="/profile?code="+t},(t,e)=>{console.error("Auth Error:",t,e),window.location.href="/"})}})]})]})})})}},6952:function(t,e,n){"use strict";n.d(e,{featureInquireInfo:function(){return r}});var c=n(305);class o{onInquireJSBridgeInfo(t){(0,c.z)(()=>{this.jsBridgeValue=t})}constructor(){this.jsBridgeValue=null,(0,c.rC)(this,{jsBridgeValue:c.LO})}}let r=new o},4687:function(t,e,n){"use strict";var c=n(6952),o=n(3562);e.Z=()=>{let{jsBridgeValue:t}=c.featureInquireInfo,e=(0,o.$)("clientId");(0,o.$)("secret");let n=(0,o.$)("callbackUrl"),r=(0,o.$)("scope"),i=(0,o.$)("acr"),a=(0,o.$)("prompt"),s=(0,o.$)("purpose"),l=(0,o.$)("state"),u=(0,o.$)("callback");if((0,o.$)("appName"),console.log("call JSBride"),console.log(u),window.JSBridge){var p,d;null===(p=(d=window.JSBridge).initAuth)||void 0===p||p.call(d,e,n,"code",r,l,a,s,i,u)}else window.webkit&&window.webkit.messageHandlers.observer.postMessage({name:"initAuth",clientId:e,redirectUri:n,responseType:"code",scope:r,state:l,prompt:a,purpose:s,acr:i,callbackOption:u})}},3562:function(t,e,n){"use strict";n.d(e,{$:function(){return o},q:function(){return c}});let c=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))},o=t=>{{let e=localStorage.getItem(t);return e?JSON.parse(e):null}}},4228:function(t,e,n){"use strict";n.d(e,{VW:function(){return r},ZO:function(){return o},lO:function(){return i}});var c=n(2126);n(9930).config();let o=async t=>{let e="".concat("https://paotang-pass-external-sit.th-service.co.in/").concat("v1/paotangpass/customer-utility/exchange-token");return await c.Z.post(e,t)},r=async t=>{let e="".concat("https://paotang-pass-external-sit.th-service.co.in/").concat("v1/paotangpass/customer-utility/get-customer-profile");return await c.Z.post(e,t)},i=async(t,e)=>{let n="".concat(e).concat("/oauth2/web/auth","?client_id=").concat(t.client_id,"&redirect_uri=").concat(t.redirect_uri,"&response_type=").concat(t.response_type,"&scope=").concat(t.scope,"&state=").concat(t.state);t.acr&&""!==t.acr.trim()&&(n+="&acr=".concat(t.acr)),t.prompt&&""!==t.prompt.trim()&&(n+="&prompt=".concat(t.prompt)),t.purpose&&""!==t.purpose.trim()&&(n+="&purpose=".concat(t.purpose)),window.open(n)}}},function(t){t.O(0,[147,218,717,190,126,12,971,23,744],function(){return t(t.s=4838)}),_N_E=t.O()}]);